# EditorConfig for PKTWinNode - .NET 9.0 WPF Application
# For details, see: https://editorconfig.org and https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/code-style-rule-options

root = true

###############################
# All Files
###############################
[*]
indent_style = space
insert_final_newline = true
charset = utf-8
trim_trailing_whitespace = true

###############################
# Code Files
###############################
[*.{cs,csx,vb,vbx}]
indent_size = 4

###############################
# XAML Files
###############################
[*.xaml]
indent_size = 4

###############################
# XML Configuration Files
###############################
[*.{xml,config,props,targets,nuspec,resx,ruleset}]
indent_size = 2

###############################
# JSON Files
###############################
[*.json]
indent_size = 2

###############################
# C# Code Style Rules
###############################
[*.cs]

# Organize usings
dotnet_sort_system_directives_first = true
dotnet_separate_import_directive_groups = false

# this. preferences (relaxed)
dotnet_style_qualification_for_field = false:suggestion
dotnet_style_qualification_for_property = false:suggestion
dotnet_style_qualification_for_method = false:suggestion
dotnet_style_qualification_for_event = false:suggestion

# Language keywords vs BCL types preferences
dotnet_style_predefined_type_for_locals_parameters_members = true:suggestion
dotnet_style_predefined_type_for_member_access = true:suggestion

# Parentheses preferences
dotnet_style_parentheses_in_arithmetic_binary_operators = always_for_clarity:suggestion
dotnet_style_parentheses_in_relational_binary_operators = always_for_clarity:suggestion
dotnet_style_parentheses_in_other_binary_operators = always_for_clarity:suggestion
dotnet_style_parentheses_in_other_operators = never_if_unnecessary:suggestion

# Modifier preferences
dotnet_style_require_accessibility_modifiers = for_non_interface_members:warning
dotnet_style_readonly_field = true:suggestion
csharp_preferred_modifier_order = public,private,protected,internal,static,extern,new,virtual,abstract,sealed,override,readonly,unsafe,volatile,async:suggestion

# Expression-level preferences (relaxed for WPF compatibility)
dotnet_style_object_initializer = true:suggestion
dotnet_style_collection_initializer = true:suggestion
dotnet_style_explicit_tuple_names = true:suggestion
dotnet_style_prefer_inferred_tuple_names = true:suggestion
dotnet_style_prefer_inferred_anonymous_type_member_names = true:suggestion
dotnet_style_prefer_auto_properties = true:suggestion
dotnet_style_prefer_conditional_expression_over_assignment = true:silent
dotnet_style_prefer_conditional_expression_over_return = true:silent
dotnet_style_prefer_compound_assignment = true:suggestion
dotnet_style_prefer_simplified_interpolation = true:suggestion
dotnet_style_prefer_simplified_boolean_expressions = true:suggestion

# Null-checking preferences (important since Nullable is enabled)
dotnet_style_coalesce_expression = true:suggestion
dotnet_style_null_propagation = true:suggestion
dotnet_style_prefer_is_null_check_over_reference_equality_method = true:suggestion

# C# Code Style Rules

# var preferences (relaxed)
csharp_style_var_for_built_in_types = false:suggestion
csharp_style_var_when_type_is_apparent = true:suggestion
csharp_style_var_elsewhere = false:suggestion

# Expression-bodied members (relaxed for readability)
csharp_style_expression_bodied_methods = false:silent
csharp_style_expression_bodied_constructors = false:silent
csharp_style_expression_bodied_operators = false:silent
csharp_style_expression_bodied_properties = true:suggestion
csharp_style_expression_bodied_indexers = true:suggestion
csharp_style_expression_bodied_accessors = true:suggestion
csharp_style_expression_bodied_lambdas = true:suggestion
csharp_style_expression_bodied_local_functions = false:silent

# Pattern matching preferences
csharp_style_pattern_matching_over_is_with_cast_check = true:suggestion
csharp_style_pattern_matching_over_as_with_null_check = true:suggestion
csharp_style_prefer_switch_expression = true:suggestion
csharp_style_prefer_pattern_matching = true:suggestion
csharp_style_prefer_not_pattern = true:suggestion
csharp_style_prefer_extended_property_pattern = true:suggestion

# Null-checking preferences
csharp_style_throw_expression = true:suggestion
csharp_style_conditional_delegate_call = true:suggestion

# Code block preferences
csharp_prefer_braces = true:warning
csharp_prefer_simple_using_statement = true:suggestion

# Expression preferences
csharp_prefer_simple_default_expression = true:suggestion
csharp_style_pattern_local_over_anonymous_function = true:suggestion
csharp_style_inlined_variable_declaration = true:suggestion
csharp_style_deconstructed_variable_declaration = true:suggestion
csharp_style_prefer_index_operator = true:suggestion
csharp_style_prefer_range_operator = true:suggestion
csharp_style_implicit_object_creation_when_type_is_apparent = true:suggestion

# 'using' directive preferences
csharp_using_directive_placement = outside_namespace:warning

# Namespace preferences (.NET 9 supports file-scoped, but existing code uses block-scoped)
csharp_style_namespace_declarations = block_scoped:silent

###############################
# C# Formatting Rules
###############################

# New line preferences
csharp_new_line_before_open_brace = all
csharp_new_line_before_else = true
csharp_new_line_before_catch = true
csharp_new_line_before_finally = true
csharp_new_line_before_members_in_object_initializers = true
csharp_new_line_before_members_in_anonymous_types = true
csharp_new_line_between_query_expression_clauses = true

# Indentation preferences
csharp_indent_case_contents = true
csharp_indent_switch_labels = true
csharp_indent_labels = no_change
csharp_indent_block_contents = true
csharp_indent_braces = false
csharp_indent_case_contents_when_block = false

# Space preferences
csharp_space_after_cast = false
csharp_space_after_keywords_in_control_flow_statements = true
csharp_space_between_parentheses = false
csharp_space_before_colon_in_inheritance_clause = true
csharp_space_after_colon_in_inheritance_clause = true
csharp_space_around_binary_operators = before_and_after
csharp_space_between_method_declaration_parameter_list_parentheses = false
csharp_space_between_method_declaration_empty_parameter_list_parentheses = false
csharp_space_between_method_declaration_name_and_open_parenthesis = false
csharp_space_between_method_call_parameter_list_parentheses = false
csharp_space_between_method_call_empty_parameter_list_parentheses = false
csharp_space_between_method_call_name_and_opening_parenthesis = false
csharp_space_after_comma = true
csharp_space_after_dot = false
csharp_space_after_semicolon_in_for_statement = true
csharp_space_before_semicolon_in_for_statement = false
csharp_space_around_declaration_statements = false
csharp_space_before_open_square_brackets = false
csharp_space_between_empty_square_brackets = false
csharp_space_between_square_brackets = false

# Wrapping preferences
csharp_preserve_single_line_statements = false
csharp_preserve_single_line_blocks = true

###############################
# Naming Conventions
###############################

# Styles
dotnet_naming_style.pascal_case_style.capitalization = pascal_case

dotnet_naming_style.camel_case_style.capitalization = camel_case

dotnet_naming_style.underscore_camel_case_style.capitalization = camel_case
dotnet_naming_style.underscore_camel_case_style.required_prefix = _

dotnet_naming_style.interface_style.capitalization = pascal_case
dotnet_naming_style.interface_style.required_prefix = I

# Constants
dotnet_naming_rule.constants_should_be_pascal_case.severity = warning
dotnet_naming_rule.constants_should_be_pascal_case.symbols = constants
dotnet_naming_rule.constants_should_be_pascal_case.style = pascal_case_style

dotnet_naming_symbols.constants.applicable_kinds = field
dotnet_naming_symbols.constants.applicable_accessibilities = *
dotnet_naming_symbols.constants.required_modifiers = const

# Interfaces
dotnet_naming_rule.interfaces_should_be_prefixed_with_i.severity = warning
dotnet_naming_rule.interfaces_should_be_prefixed_with_i.symbols = interfaces
dotnet_naming_rule.interfaces_should_be_prefixed_with_i.style = interface_style

dotnet_naming_symbols.interfaces.applicable_kinds = interface
dotnet_naming_symbols.interfaces.applicable_accessibilities = *

# Private fields with underscore (common in MVVM)
dotnet_naming_rule.private_fields_should_be_underscore_camel_case.severity = warning
dotnet_naming_rule.private_fields_should_be_underscore_camel_case.symbols = private_fields
dotnet_naming_rule.private_fields_should_be_underscore_camel_case.style = underscore_camel_case_style

dotnet_naming_symbols.private_fields.applicable_kinds = field
dotnet_naming_symbols.private_fields.applicable_accessibilities = private

# Public/Internal fields (discouraged but not error)
dotnet_naming_rule.non_private_fields_should_be_pascal_case.severity = suggestion
dotnet_naming_rule.non_private_fields_should_be_pascal_case.symbols = non_private_fields
dotnet_naming_rule.non_private_fields_should_be_pascal_case.style = pascal_case_style

dotnet_naming_symbols.non_private_fields.applicable_kinds = field
dotnet_naming_symbols.non_private_fields.applicable_accessibilities = public,internal,protected,protected_internal

# Types (classes, structs, enums, etc.)
dotnet_naming_rule.types_should_be_pascal_case.severity = warning
dotnet_naming_rule.types_should_be_pascal_case.symbols = types
dotnet_naming_rule.types_should_be_pascal_case.style = pascal_case_style

dotnet_naming_symbols.types.applicable_kinds = class,struct,enum,delegate,record

# Methods, properties, events
dotnet_naming_rule.methods_should_be_pascal_case.severity = warning
dotnet_naming_rule.methods_should_be_pascal_case.symbols = methods
dotnet_naming_rule.methods_should_be_pascal_case.style = pascal_case_style

dotnet_naming_symbols.methods.applicable_kinds = method,property,event

# Parameters and locals
dotnet_naming_rule.parameters_should_be_camel_case.severity = warning
dotnet_naming_rule.parameters_should_be_camel_case.symbols = parameters
dotnet_naming_rule.parameters_should_be_camel_case.style = camel_case_style

dotnet_naming_symbols.parameters.applicable_kinds = parameter,local

###############################
# .NET Code Quality Rules (Relaxed)
###############################

# Design rules
dotnet_diagnostic.CA1001.severity = warning  # Types that own disposable fields should be disposable
dotnet_diagnostic.CA1008.severity = suggestion  # Enums should have zero value
dotnet_diagnostic.CA1012.severity = suggestion  # Abstract types should not have constructors
dotnet_diagnostic.CA1014.severity = none  # Mark assemblies with CLSCompliant (not needed for WPF)
dotnet_diagnostic.CA1016.severity = none  # Mark assemblies with assembly version
dotnet_diagnostic.CA1017.severity = none  # Mark assemblies with ComVisible
dotnet_diagnostic.CA1018.severity = suggestion  # Mark attributes with AttributeUsageAttribute
dotnet_diagnostic.CA1028.severity = suggestion  # Enum storage should be Int32
dotnet_diagnostic.CA1030.severity = suggestion  # Use events where appropriate
dotnet_diagnostic.CA1031.severity = suggestion  # Do not catch general exception types (relaxed since project uses it)
dotnet_diagnostic.CA1032.severity = suggestion  # Implement standard exception constructors
dotnet_diagnostic.CA1033.severity = suggestion  # Interface methods should be callable by child types
dotnet_diagnostic.CA1034.severity = suggestion  # Nested types should not be visible
dotnet_diagnostic.CA1036.severity = suggestion  # Override methods on comparable types
dotnet_diagnostic.CA1040.severity = suggestion  # Avoid empty interfaces
dotnet_diagnostic.CA1041.severity = warning  # Provide ObsoleteAttribute message
dotnet_diagnostic.CA1043.severity = suggestion  # Use integral or string argument for indexers
dotnet_diagnostic.CA1044.severity = suggestion  # Properties should not be write only
dotnet_diagnostic.CA1045.severity = none  # Do not pass types by reference (allowed for performance)
dotnet_diagnostic.CA1046.severity = suggestion  # Do not overload operator equals on reference types
dotnet_diagnostic.CA1050.severity = warning  # Declare types in namespaces
dotnet_diagnostic.CA1051.severity = suggestion  # Do not declare visible instance fields
dotnet_diagnostic.CA1052.severity = suggestion  # Static holder types should be Static or NotInheritable
dotnet_diagnostic.CA1054.severity = suggestion  # URI parameters should not be strings
dotnet_diagnostic.CA1055.severity = suggestion  # URI return values should not be strings
dotnet_diagnostic.CA1056.severity = suggestion  # URI properties should not be strings
dotnet_diagnostic.CA1058.severity = suggestion  # Types should not extend certain base types
dotnet_diagnostic.CA1060.severity = suggestion  # Move P/Invokes to NativeMethods class
dotnet_diagnostic.CA1061.severity = warning  # Do not hide base class methods
dotnet_diagnostic.CA1062.severity = suggestion  # Validate arguments of public methods (relaxed)
dotnet_diagnostic.CA1063.severity = warning  # Implement IDisposable correctly
dotnet_diagnostic.CA1064.severity = suggestion  # Exceptions should be public
dotnet_diagnostic.CA1065.severity = warning  # Do not raise exceptions in unexpected locations
dotnet_diagnostic.CA1066.severity = suggestion  # Implement IEquatable when overriding Equals
dotnet_diagnostic.CA1067.severity = warning  # Override Equals when implementing IEquatable
dotnet_diagnostic.CA1068.severity = warning  # CancellationToken parameters must come last
dotnet_diagnostic.CA1069.severity = warning  # Enums should not have duplicate values
dotnet_diagnostic.CA1070.severity = warning  # Do not declare event fields as virtual

# Globalization rules
dotnet_diagnostic.CA1303.severity = none  # Do not pass literals as localized parameters (WPF not localized)
dotnet_diagnostic.CA1304.severity = suggestion  # Specify CultureInfo
dotnet_diagnostic.CA1305.severity = suggestion  # Specify IFormatProvider
dotnet_diagnostic.CA1307.severity = suggestion  # Specify StringComparison
dotnet_diagnostic.CA1308.severity = suggestion  # Normalize strings to uppercase
dotnet_diagnostic.CA1309.severity = suggestion  # Use ordinal StringComparison
dotnet_diagnostic.CA1310.severity = suggestion  # Specify StringComparison for correctness

# Performance rules
dotnet_diagnostic.CA1802.severity = suggestion  # Use Literals Where Appropriate
dotnet_diagnostic.CA1805.severity = suggestion  # Do not initialize unnecessarily
dotnet_diagnostic.CA1806.severity = warning  # Do not ignore method results
dotnet_diagnostic.CA1810.severity = suggestion  # Initialize reference type static fields inline
dotnet_diagnostic.CA1812.severity = suggestion  # Avoid uninstantiated internal classes
dotnet_diagnostic.CA1813.severity = suggestion  # Avoid unsealed attributes
dotnet_diagnostic.CA1814.severity = suggestion  # Prefer jagged arrays over multidimensional
dotnet_diagnostic.CA1815.severity = suggestion  # Override equals and operator equals on value types
dotnet_diagnostic.CA1816.severity = warning  # Call GC.SuppressFinalize correctly
dotnet_diagnostic.CA1819.severity = suggestion  # Properties should not return arrays
dotnet_diagnostic.CA1820.severity = suggestion  # Test for empty strings using string length
dotnet_diagnostic.CA1821.severity = warning  # Remove empty finalizers
dotnet_diagnostic.CA1822.severity = suggestion  # Mark members as static
dotnet_diagnostic.CA1823.severity = warning  # Avoid unused private fields
dotnet_diagnostic.CA1824.severity = suggestion  # Mark assemblies with NeutralResourcesLanguageAttribute
dotnet_diagnostic.CA1825.severity = suggestion  # Avoid zero-length array allocations
dotnet_diagnostic.CA1826.severity = suggestion  # Use property instead of Linq Enumerable method
dotnet_diagnostic.CA1827.severity = suggestion  # Do not use Count/LongCount when Any can be used
dotnet_diagnostic.CA1828.severity = suggestion  # Do not use CountAsync/LongCountAsync when AnyAsync can be used
dotnet_diagnostic.CA1829.severity = suggestion  # Use Length/Count property instead of Enumerable.Count method
dotnet_diagnostic.CA1830.severity = suggestion  # Prefer strongly-typed Append and Insert method overloads on StringBuilder
dotnet_diagnostic.CA1831.severity = suggestion  # Use AsSpan instead of Range-based indexers for string
dotnet_diagnostic.CA1832.severity = suggestion  # Use AsSpan or AsMemory instead of Range-based indexers
dotnet_diagnostic.CA1833.severity = suggestion  # Use AsSpan or AsMemory instead of Range-based indexers
dotnet_diagnostic.CA1834.severity = suggestion  # Use StringBuilder.Append(char) for single character strings
dotnet_diagnostic.CA1835.severity = suggestion  # Prefer the memory-based overloads of ReadAsync/WriteAsync methods
dotnet_diagnostic.CA1836.severity = suggestion  # Prefer IsEmpty over Count when available
dotnet_diagnostic.CA1837.severity = suggestion  # Use Environment.ProcessId instead of Process.GetCurrentProcess().Id
dotnet_diagnostic.CA1838.severity = suggestion  # Avoid StringBuilder parameters for P/Invokes

# Reliability rules
dotnet_diagnostic.CA2000.severity = warning  # Dispose objects before losing scope
dotnet_diagnostic.CA2002.severity = warning  # Do not lock on objects with weak identity
dotnet_diagnostic.CA2007.severity = none  # Do not directly await a Task (not needed for WPF UI context)
dotnet_diagnostic.CA2008.severity = suggestion  # Do not create tasks without passing a TaskScheduler
dotnet_diagnostic.CA2009.severity = warning  # Do not call ToImmutableCollection on an ImmutableCollection value
dotnet_diagnostic.CA2011.severity = warning  # Do not assign property within its setter
dotnet_diagnostic.CA2012.severity = warning  # Use ValueTasks correctly
dotnet_diagnostic.CA2013.severity = warning  # Do not use ReferenceEquals with value types
dotnet_diagnostic.CA2014.severity = warning  # Do not use stackalloc in loops
dotnet_diagnostic.CA2015.severity = warning  # Do not define finalizers for types derived from MemoryManager<T>
dotnet_diagnostic.CA2016.severity = suggestion  # Forward the CancellationToken parameter

# Security rules (most set to suggestion since this is a desktop app)
dotnet_diagnostic.CA2100.severity = warning  # Review SQL queries for security vulnerabilities
dotnet_diagnostic.CA2109.severity = suggestion  # Review visible event handlers
dotnet_diagnostic.CA2119.severity = suggestion  # Seal methods that satisfy private interfaces
dotnet_diagnostic.CA2153.severity = warning  # Avoid handling Corrupted State Exceptions
dotnet_diagnostic.CA2300.severity = warning  # Do not use insecure deserializer BinaryFormatter
dotnet_diagnostic.CA2301.severity = warning  # Do not call BinaryFormatter.Deserialize without first setting BinaryFormatter.Binder
dotnet_diagnostic.CA2302.severity = warning  # Ensure BinaryFormatter.Binder is set before calling BinaryFormatter.Deserialize
dotnet_diagnostic.CA2305.severity = warning  # Do not use insecure deserializer LosFormatter
dotnet_diagnostic.CA2310.severity = warning  # Do not use insecure deserializer NetDataContractSerializer
dotnet_diagnostic.CA2311.severity = warning  # Do not deserialize without first setting NetDataContractSerializer.Binder
dotnet_diagnostic.CA2312.severity = warning  # Ensure NetDataContractSerializer.Binder is set before deserializing
dotnet_diagnostic.CA2315.severity = warning  # Do not use insecure deserializer ObjectStateFormatter
dotnet_diagnostic.CA2321.severity = warning  # Do not deserialize with JavaScriptSerializer using a SimpleTypeResolver
dotnet_diagnostic.CA2322.severity = warning  # Ensure JavaScriptSerializer is not initialized with SimpleTypeResolver before deserializing

# Usage rules
dotnet_diagnostic.CA2200.severity = warning  # Rethrow to preserve stack details
dotnet_diagnostic.CA2201.severity = suggestion  # Do not raise reserved exception types
dotnet_diagnostic.CA2207.severity = warning  # Initialize value type static fields inline
dotnet_diagnostic.CA2208.severity = warning  # Instantiate argument exceptions correctly
dotnet_diagnostic.CA2211.severity = suggestion  # Non-constant fields should not be visible
dotnet_diagnostic.CA2213.severity = warning  # Disposable fields should be disposed
dotnet_diagnostic.CA2214.severity = warning  # Do not call overridable methods in constructors
dotnet_diagnostic.CA2215.severity = warning  # Dispose methods should call base class dispose
dotnet_diagnostic.CA2216.severity = suggestion  # Disposable types should declare finalizer
dotnet_diagnostic.CA2217.severity = suggestion  # Do not mark enums with FlagsAttribute
dotnet_diagnostic.CA2218.severity = warning  # Override GetHashCode on overriding Equals
dotnet_diagnostic.CA2219.severity = warning  # Do not raise exceptions in exception clauses
dotnet_diagnostic.CA2224.severity = warning  # Override Equals on overloading operator equals
dotnet_diagnostic.CA2225.severity = suggestion  # Operator overloads have named alternates
dotnet_diagnostic.CA2226.severity = suggestion  # Operators should have symmetrical overloads
dotnet_diagnostic.CA2227.severity = none  # Collection properties should be read only (WPF uses ObservableCollection)
dotnet_diagnostic.CA2229.severity = suggestion  # Implement serialization constructors
dotnet_diagnostic.CA2231.severity = suggestion  # Overload operator equals on overriding ValueType.Equals
dotnet_diagnostic.CA2234.severity = suggestion  # Pass System.Uri objects instead of strings
dotnet_diagnostic.CA2235.severity = suggestion  # Mark all non-serializable fields
dotnet_diagnostic.CA2237.severity = suggestion  # Mark ISerializable types with SerializableAttribute
dotnet_diagnostic.CA2241.severity = warning  # Provide correct arguments to formatting methods
dotnet_diagnostic.CA2242.severity = warning  # Test for NaN correctly
dotnet_diagnostic.CA2243.severity = suggestion  # Attribute string literals should parse correctly
dotnet_diagnostic.CA2244.severity = warning  # Do not duplicate indexed element initializations
dotnet_diagnostic.CA2245.severity = warning  # Do not assign a property to itself
dotnet_diagnostic.CA2246.severity = warning  # Do not assign a symbol and its member in the same statement
dotnet_diagnostic.CA2247.severity = warning  # Argument passed to TaskCompletionSource constructor should be TaskCreationOptions enum
dotnet_diagnostic.CA2248.severity = warning  # Provide correct enum argument to Enum.HasFlag
dotnet_diagnostic.CA2249.severity = suggestion  # Consider using String.Contains instead of String.IndexOf

# Style rules (IDE rules shown in IDE)
dotnet_diagnostic.IDE0001.severity = suggestion  # Simplify name
dotnet_diagnostic.IDE0002.severity = suggestion  # Simplify member access
dotnet_diagnostic.IDE0003.severity = suggestion  # Remove this or Me qualification
dotnet_diagnostic.IDE0004.severity = suggestion  # Remove unnecessary cast
dotnet_diagnostic.IDE0005.severity = warning  # Remove unnecessary using directives
dotnet_diagnostic.IDE0011.severity = suggestion  # Add braces
dotnet_diagnostic.IDE0055.severity = suggestion  # Formatting rule violations
dotnet_diagnostic.IDE0058.severity = none  # Expression value is never used (too noisy for WPF)
dotnet_diagnostic.IDE0059.severity = suggestion  # Unnecessary assignment of a value
dotnet_diagnostic.IDE0060.severity = suggestion  # Remove unused parameter
dotnet_diagnostic.IDE0079.severity = suggestion  # Remove unnecessary suppression
dotnet_diagnostic.IDE0080.severity = suggestion  # Remove unnecessary suppression operator
dotnet_diagnostic.IDE0100.severity = suggestion  # Remove unnecessary equality operator
dotnet_diagnostic.IDE0110.severity = suggestion  # Remove unnecessary discard
